<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TVA Temporal Defense Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=B612+Mono:wght@400;700&family=DM+Serif+Display:ital@0;1&family=Space+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'tva': {
                'amber': '#FF8B28',
                'orange': '#FF6B00',
                'brown': '#794B28',
                'dark': '#251F17',
                'tan': '#D6BC97',
                'cream': '#F5E9D7',
                'black': '#1A1512',
              },
            },
            fontFamily: {
              'serif': ['"DM Serif Display"', 'serif'],
              'mono': ['"B612 Mono"', 'monospace'],
            },
          },
        },
      };
    </script>

    <style>
      /* CRT screen effect - maintain scanlines but remove harsh flickering */
      .crt::before {
        content: ' ';
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(
            rgba(18, 16, 16, 0) 50%,
            rgba(0, 0, 0, 0.1) 50%
          ),
          linear-gradient(
            90deg,
            rgba(255, 0, 0, 0.03),
            rgba(0, 255, 0, 0.02),
            rgba(0, 0, 255, 0.03)
          );
        background-size: 100% 2px, 3px 100%;
        pointer-events: none;
        z-index: 100;
      }

      /* Optional subtle ambient glow instead */
      .crt::after {
        content: ' ';
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: radial-gradient(
          circle at center,
          transparent 60%,
          rgba(255, 107, 0, 0.09) 100%
        );
        pointer-events: none;
        z-index: 50;
      }

      /* Typewriter text effect */
      .typewriter {
        overflow: hidden;
        border-right: 0.15em solid #ff6b00;
        white-space: nowrap;
        letter-spacing: 0.15em;
        animation: typing 3.5s steps(40, end),
          blink-caret 0.75s step-end infinite;
      }

      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }

      @keyframes blink-caret {
        from,
        to {
          border-color: transparent;
        }
        50% {
          border-color: #ff6b00;
        }
      }

      /* TVA folder tab styling */
      .tva-tab {
        position: relative;
        overflow: hidden;
      }

      .tva-tab::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #d6bc97;
        clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
        z-index: -1;
      }

      /* TVA stamp effect */
      .tva-stamp {
        position: relative;
      }

      .tva-stamp::after {
        content: 'VARIANT';
        position: absolute;
        top: -15px;
        right: -15px;
        background: #ff6b00;
        color: #1a1512;
        padding: 5px 10px;
        font-family: 'B612 Mono', monospace;
        font-weight: bold;
        font-size: 0.6rem;
        transform: rotate(15deg);
        border: 1px solid #1a1512;
      }

      /* File folder styling */
      .file-folder {
        position: relative;
        background: #d6bc97;
        border: 1px solid #794b28;
        box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.2);
      }

      .file-tab {
        position: absolute;
        top: -15px;
        left: 20px;
        width: 80px;
        height: 15px;
        background: #d6bc97;
        border: 1px solid #794b28;
        border-bottom: none;
        border-radius: 5px 5px 0 0;
      }

      /* Scrollbar styling */
      ::-webkit-scrollbar {
        width: 14px;
        height: 14px;
      }

      ::-webkit-scrollbar-track {
        background: #251f17;
      }

      ::-webkit-scrollbar-thumb {
        background: #ff6b00;
        border: 2px solid #251f17;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #ff8b28;
      }

      /* Old CRT monitor glow */
      .monitor-glow {
        box-shadow: 0 0 10px rgba(255, 107, 0, 0.3),
          0 0 20px rgba(255, 107, 0, 0.2), inset 0 0 30px rgba(255, 107, 0, 0.2);
      }

      /* Miss Minutes dot animation */
      .miss-minutes-dot {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(0.9);
        }
      }

      body {
        background-color: #1a1512; /* Darker than the previous #251f17 */
        background-image: linear-gradient(
            rgba(255, 107, 0, 0.07) 1px,
            /* Slightly increased grid opacity for visibility */ transparent 1px
          ),
          linear-gradient(90deg, rgba(255, 107, 0, 0.07) 1px, transparent 1px);
        background-size: 20px 20px;
      }

      [x-cloak] {
        display: none !important;
      }

      /* Add these styles for timeline effects */
      .chart-container {
        position: relative;
        height: 280px;
        width: 100%;
        overflow: hidden;
      }

      /* Red line through timeline (similar to TVA's red timeline indicator) */
      .timeline-divider {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        width: 3px;
        background-color: rgba(255, 107, 0, 0.7);
        transform: translateX(50px);
        box-shadow: 0 0 10px rgba(255, 107, 0, 0.5);
        z-index: 1;
        animation: timeline-pulse 2s infinite;
      }

      @keyframes timeline-pulse {
        0%,
        100% {
          opacity: 1;
          box-shadow: 0 0 10px rgba(255, 107, 0, 0.5);
        }
        50% {
          opacity: 0.6;
          box-shadow: 0 0 15px rgba(255, 107, 0, 0.7);
        }
      }

      /* Update the chart section container */
      .mt-8.bg-tva-cream.rounded.border-2.border-tva-brown.monitor-glow {
        position: relative;
        overflow: hidden;
      }

      .mt-8.bg-tva-cream.rounded.border-2.border-tva-brown.monitor-glow::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: repeating-linear-gradient(
          to right,
          rgba(121, 75, 40, 0.05) 0px,
          rgba(121, 75, 40, 0.05) 1px,
          transparent 1px,
          transparent 20px
        );
        pointer-events: none;
      }
    </style>
  </head>

  <body class="font-mono text-tva-tan crt relative" x-data="dashboard()">
    <div class="min-h-screen flex">
      <!-- TVA Sidebar -->
      <div
        class="bg-tva-dark border-r-2 border-tva-orange w-64 fixed h-full overflow-y-auto monitor-glow"
      >
        <div
          class="p-4 flex items-center space-x-3 border-b-2 border-tva-brown"
        >
          <div
            class="w-10 h-10 rounded-full bg-tva-amber flex items-center justify-center overflow-hidden"
          >
            <div class="w-8 h-8 relative">
              <!-- Simple Miss Minutes inspired icon -->
              <div
                class="absolute inset-0 rounded-full border-4 border-tva-dark"
              ></div>
              <div
                class="absolute inset-1 rounded-full bg-tva-orange miss-minutes-dot"
              ></div>
              <div
                class="absolute top-[45%] left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-1 bg-tva-dark rounded"
              ></div>
              <div
                class="absolute top-[25%] left-[25%] w-1 h-1 bg-tva-dark rounded-full"
              ></div>
              <div
                class="absolute top-[25%] right-[25%] w-1 h-1 bg-tva-dark rounded-full"
              ></div>
            </div>
          </div>
          <div>
            <h1 class="text-xl font-serif text-tva-amber tracking-wide">
              TVA INTERFACE
            </h1>
            <p class="text-xs text-tva-tan opacity-70">TEMPORAL DEFENSE</p>
          </div>
        </div>

        <div class="pt-6 pb-2 px-4">
          <p
            class="uppercase text-xs tracking-widest text-tva-orange opacity-80"
          >
            TIMELINE STATUS
          </p>
          <div
            class="mt-2 px-2 py-2 bg-tva-black/30 rounded border border-tva-brown flex justify-between items-center"
          >
            <span class="text-sm">Sacred Timeline</span>
            <div class="flex items-center space-x-2">
              <div
                class="w-2 h-2 rounded-full miss-minutes-dot"
                :class="status === 'running' ? 'bg-tva-amber' : 'bg-red-500'"
              ></div>
              <span
                class="text-xs uppercase font-mono"
                :class="status === 'running' ? 'text-tva-amber' : 'text-red-500'"
                x-text="status === 'running' ? 'PROTECTED' : 'BREACHED'"
              ></span>
            </div>
          </div>
        </div>

        <div class="px-4 py-3">
          <span class="text-xs text-tva-tan opacity-70 font-mono"
            >Authorized Access Only</span
          >
          <div class="mt-1 w-full h-1 bg-tva-black overflow-hidden">
            <div class="h-full bg-tva-orange" style="width: 73%"></div>
          </div>
        </div>

        <nav class="mt-2">
          <div class="px-4 py-2">
            <p
              class="uppercase text-xs tracking-widest text-tva-orange opacity-80 mb-2"
            >
              CONSOLE ACCESS
            </p>

            <a
              href="/"
              class="flex items-center space-x-3 px-3 py-2 rounded transition-colors duration-200 border"
              :class="currentPage === 'dashboard' ? 'bg-tva-orange/20 border-tva-orange text-tva-amber' : 'border-transparent hover:bg-tva-orange/10 text-tva-tan'"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"
                />
              </svg>
              <span>MAIN CONSOLE</span>
            </a>

            <a
              href="/blocklists"
              class="flex items-center space-x-3 px-3 py-2 rounded mt-2 transition-colors duration-200 border"
              :class="currentPage === 'blocklists' ? 'bg-tva-orange/20 border-tva-orange text-tva-amber' : 'border-transparent hover:bg-tva-orange/10 text-tva-tan'"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
                />
              </svg>
              <span>VARIANT FILES</span>
            </a>

            <a
              href="/settings"
              class="flex items-center space-x-3 px-3 py-2 rounded mt-2 transition-colors duration-200 border"
              :class="currentPage === 'settings' ? 'bg-tva-orange/20 border-tva-orange text-tva-amber' : 'border-transparent hover:bg-tva-orange/10 text-tva-tan'"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"
                />
              </svg>
              <span>TEMPPAD CONFIG</span>
            </a>

            <a
              href="/about"
              class="flex items-center space-x-3 px-3 py-2 rounded mt-2 transition-colors duration-200 border"
              :class="currentPage === 'about' ? 'bg-tva-orange/20 border-tva-orange text-tva-amber' : 'border-transparent hover:bg-tva-orange/10 text-tva-tan'"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
              <span>TIME KEEPERS</span>
            </a>
          </div>
        </nav>

        <div
          class="absolute bottom-0 left-0 right-0 p-4 border-t border-tva-brown"
        >
          <div class="text-xs font-mono">
            <p class="text-center text-tva-orange">TIME VARIANCE AUTHORITY</p>
            <div class="flex justify-center space-x-4 mt-2">
              <div>V.1.0.3</div>
              <div class="miss-minutes-dot text-tva-amber">●</div>
              <div>FOR ALL TIME. ALWAYS.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <main class="ml-64 flex-1 p-6 pb-24">
        <!-- Dashboard content (show when currentPage is dashboard) -->
        <div x-show="currentPage === 'dashboard'">
          <header class="flex justify-between items-center mb-8">
            <div>
              <h1 class="text-3xl font-serif text-tva-amber">
                Variant Detection Center
              </h1>
              <p class="text-sm text-tva-tan mt-1 opacity-70 font-mono">
                ACTIVE MONITORING: DOMAIN NEXUS BRANCH-38F
              </p>
            </div>

            <div
              class="border border-tva-orange px-4 py-1 rounded bg-tva-black/30 monitor-glow"
            >
              <div class="text-xs text-tva-orange mb-1 font-mono">
                TIMELINE INTEGRITY:
              </div>
              <div class="flex items-center space-x-2">
                <span
                  class="text-tva-amber font-serif text-xl"
                  x-text="status === 'running' ? 'STABLE' : 'COMPROMISED'"
                ></span>
                <span class="miss-minutes-dot text-tva-amber text-lg">●</span>
              </div>
            </div>
          </header>

          <!-- Timestamp -->
          <div class="flex justify-between items-center mb-6">
            <div
              class="text-sm text-tva-orange font-mono border-b border-tva-orange/30 inline-block pb-1 typewriter"
            >
              TIMESTAMP: <span x-text="new Date().toLocaleString()"></span>
            </div>
            <div class="text-sm text-tva-orange font-mono">
              OPERATION:
              <span class="text-tva-amber">TIMELINE DEFENSE PROTOCOL</span>
            </div>
          </div>

          <!-- Stats Cards -->
          <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
            <div class="file-folder overflow-hidden rounded">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-tva-orange p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-black"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Total Nexus Events
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.totalQueries"
                    ></p>
                  </div>
                </div>
              </div>
            </div>

            <div class="file-folder overflow-hidden rounded tva-stamp">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-red-600 p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-cream"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Pruned Branches
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.blockedQueries"
                    ></p>
                  </div>
                </div>
              </div>
            </div>

            <div class="file-folder overflow-hidden rounded">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-tva-amber p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-dark"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Archive Retrievals
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.cacheHits"
                    ></p>
                  </div>
                </div>
              </div>
            </div>

            <div class="file-folder overflow-hidden rounded">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-tva-brown p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-cream"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Pruning Rate
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.totalQueries > 0 ? ((metrics.blockedQueries / metrics.totalQueries) * 100).toFixed(1) + '%' : '0%'"
                    ></p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Chart Section -->
          <div
            class="mt-8 bg-tva-cream rounded border-2 border-tva-brown monitor-glow"
          >
            <div
              class="bg-tva-brown text-tva-cream px-6 py-3 flex justify-between items-center"
            >
              <h2 class="text-lg font-serif">TIMELINE BRANCH ANALYSIS</h2>
              <div
                class="text-xs font-mono bg-tva-orange/20 px-3 py-1 rounded text-tva-orange border border-tva-orange"
              >
                CLASSIFIED
              </div>
            </div>
            <div class="p-6 bg-tva-cream">
              <div class="chart-container">
                <canvas id="statsChart"></canvas>
                <!-- The timeline-divider will be added by JavaScript -->
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
            <!-- Variant registry table -->
            <div
              class="bg-tva-cream rounded border-2 border-tva-brown monitor-glow"
            >
              <div class="bg-tva-brown text-tva-cream px-6 py-3">
                <h2 class="text-lg font-serif">SUBJECT REGISTRY</h2>
              </div>
              <div class="overflow-x-auto" style="max-height: 400px">
                <table class="min-w-full">
                  <thead class="bg-tva-tan border-b border-tva-brown">
                    <tr>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        IP IDENTIFIER
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        EVENTS
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        PRUNED
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        LAST DETECTION
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    class="divide-y divide-tva-brown/30 bg-tva-cream text-tva-dark"
                  >
                    <template x-for="client in clientStats" :key="client.ip">
                      <tr
                        class="hover:bg-tva-tan transition-colors cursor-pointer"
                      >
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm font-mono"
                          x-text="client.ip"
                        ></td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm"
                          x-text="client.totalQueries"
                        ></td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm"
                          x-text="client.blockedQueries"
                        ></td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm text-tva-brown"
                          x-text="client.lastSeen"
                        ></td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Recent Variants -->
            <div
              class="bg-tva-cream rounded border-2 border-tva-brown monitor-glow"
            >
              <div class="bg-tva-brown text-tva-cream px-6 py-3">
                <h2 class="text-lg font-serif">NEXUS EVENT LOG</h2>
              </div>
              <div class="overflow-x-auto" style="max-height: 400px">
                <table class="min-w-full">
                  <thead class="bg-tva-tan border-b border-tva-brown">
                    <tr>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        DOMAIN
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        STATUS
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        TIMESTAMP
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    class="divide-y divide-tva-brown/30 bg-tva-cream text-tva-dark"
                  >
                    <template x-for="query in recentQueries" :key="query.id">
                      <tr
                        class="hover:bg-tva-tan transition-colors cursor-pointer"
                      >
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm font-mono"
                          x-text="query.domain"
                        ></td>
                        <td class="px-6 py-4 whitespace-nowrap">
                          <span
                            class="px-2 py-1 text-xs font-mono uppercase"
                            :class="query.blocked ? 'bg-red-100 text-red-800 border-red-800' : 'bg-green-100 text-green-800 border-green-800'"
                            x-text="query.blocked ? 'BLOCKED' : 'ALLOWED'"
                          ></span>
                        </td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm text-tva-brown"
                          x-text="query.time"
                        ></td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Footer -->
          <footer class="mt-12 pb-6">
            <div class="text-center text-xs text-tva-tan">
              <p>
                GoAdBlock Defense System • Operational Time:
                <span x-text="getUptime()"></span>
              </p>
            </div>
          </footer>
        </div>

        <!-- Blocklists content (show when currentPage is blocklists) -->
        <div x-show="currentPage === 'blocklists'" x-cloak>
          <header
            class="flex justify-between items-center mb-8 pb-4 border-b border-neo-blue border-opacity-20"
          >
            <h1 class="text-2xl font-orbitron font-bold glow-text-blue">
              Blocklist Management
            </h1>
            <!-- Status indicator -->
          </header>

          <!-- Blocklist content -->
          <div class="bg-neo-dark neo-border neo-overlay rounded-lg p-6">
            <!-- Table for blocklists -->
          </div>
        </div>

        <!-- Settings content (show when currentPage is settings) -->
        <div x-show="currentPage === 'settings'" x-cloak>
          <!-- Settings content -->
        </div>

        <!-- About content (show when currentPage is about) -->
        <div x-show="currentPage === 'about'" x-cloak>
          <!-- About content -->
        </div>
      </main>
    </div>

    <script>
      // Update the dashboard function to handle navigation
      function dashboard() {
        let chart = null;
        const startTime = new Date();

        return {
          status: 'running',
          metrics: {
            totalQueries: 0,
            blockedQueries: 0,
            cacheHits: 0,
            cacheMisses: 0,
          },
          recentQueries: [],
          hourlyStats: {
            labels: [],
            requests: [],
            blocks: [],
          },
          clientStats: [],
          currentPage: 'dashboard', // Default to dashboard

          init() {
            this.initChart();
            this.fetchData();
            // Update every 2 seconds
            setInterval(() => this.fetchData(), 2000);

            // Determine current page from URL
            const path = window.location.pathname;
            if (path.includes('/blocklists')) {
              this.currentPage = 'blocklists';
            } else if (path.includes('/settings')) {
              this.currentPage = 'settings';
            } else if (path.includes('/about')) {
              this.currentPage = 'about';
            } else {
              this.currentPage = 'dashboard';
            }
          },

          getUptime() {
            const now = new Date();
            const diff = now - startTime;
            const hours = Math.floor(diff / 3600000);
            const minutes = Math.floor((diff % 3600000) / 60000);
            const seconds = Math.floor((diff % 60000) / 1000);
            return `${hours.toString().padStart(2, '0')}:${minutes
              .toString()
              .padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
          },

          initChart() {
            const ctx = document.getElementById('statsChart').getContext('2d');

            // Custom gradient for the sacred timeline
            const sacredTimelineGradient = ctx.createLinearGradient(
              0,
              0,
              0,
              300
            );
            sacredTimelineGradient.addColorStop(0, 'rgba(255, 107, 0, 0.8)');
            sacredTimelineGradient.addColorStop(1, 'rgba(255, 139, 40, 0.3)');

            // Custom gradient for the variant timeline
            const variantTimelineGradient = ctx.createLinearGradient(
              0,
              0,
              0,
              300
            );
            variantTimelineGradient.addColorStop(0, 'rgba(121, 75, 40, 0.8)');
            variantTimelineGradient.addColorStop(1, 'rgba(121, 75, 40, 0.3)');

            Chart.defaults.color = '#794B28';
            Chart.defaults.font.family = "'B612 Mono', monospace";

            chart = new Chart(ctx, {
              type: 'line',
              data: {
                labels: [],
                datasets: [
                  {
                    label: 'Sacred Timeline',
                    borderColor: '#FF6B00',
                    backgroundColor: sacredTimelineGradient,
                    borderWidth: 3,
                    pointBackgroundColor: '#FF6B00',
                    pointBorderColor: '#1A1512',
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    data: [],
                    fill: true,
                    tension: 0.2,
                    pointStyle: 'rectRot',
                    borderDash: [],
                  },
                  {
                    label: 'Variant Branches',
                    borderColor: '#794B28',
                    backgroundColor: variantTimelineGradient,
                    borderWidth: 2,
                    pointBackgroundColor: '#794B28',
                    pointBorderColor: '#1A1512',
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    data: [],
                    fill: true,
                    tension: 0.2,
                    borderDash: [5, 5],
                    pointStyle: 'rectRot',
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                  duration: 1500,
                  easing: 'easeOutQuart',
                },
                plugins: {
                  legend: {
                    position: 'top',
                    labels: {
                      boxWidth: 15,
                      usePointStyle: true,
                      pointStyle: 'rectRot',
                      padding: 20,
                      font: {
                        family: "'B612 Mono', monospace",
                        size: 12,
                      },
                      color: '#794B28',
                    },
                  },
                  tooltip: {
                    backgroundColor: 'rgba(214, 188, 151, 0.9)',
                    titleFont: {
                      family: "'DM Serif Display', serif",
                      size: 14,
                      weight: 'bold',
                    },
                    bodyFont: {
                      family: "'B612 Mono', monospace",
                      size: 12,
                    },
                    borderColor: '#FF6B00',
                    borderWidth: 2,
                    titleColor: '#251F17',
                    bodyColor: '#251F17',
                    padding: 12,
                    boxPadding: 5,
                    displayColors: true,
                    callbacks: {
                      title: function (tooltipItems) {
                        return 'TIMELINE POINT: ' + tooltipItems[0].label;
                      },
                    },
                  },
                },
                scales: {
                  y: {
                    beginAtZero: true,
                    ticks: {
                      font: {
                        family: "'B612 Mono', monospace",
                        size: 10,
                      },
                      color: '#794B28',
                    },
                    grid: {
                      color: 'rgba(121, 75, 40, 0.15)',
                      drawBorder: false,
                    },
                    title: {
                      display: true,
                      text: 'TIMELINE MAGNITUDE',
                      font: {
                        family: "'B612 Mono', monospace",
                        size: 10,
                        weight: 'bold',
                      },
                      color: '#794B28',
                    },
                  },
                  x: {
                    grid: {
                      color: 'rgba(121, 75, 40, 0.1)',
                      drawBorder: false,
                    },
                    ticks: {
                      font: {
                        family: "'B612 Mono', monospace",
                        size: 10,
                      },
                      color: '#794B28',
                    },
                    title: {
                      display: true,
                      text: 'TEMPORAL COORDINATES',
                      font: {
                        family: "'B612 Mono', monospace",
                        size: 10,
                        weight: 'bold',
                      },
                      color: '#794B28',
                    },
                  },
                },
                elements: {
                  line: {
                    borderWidth: 3,
                    borderCapStyle: 'round',
                  },
                  point: {
                    hitRadius: 10,
                    hoverRadius: 8,
                    hoverBorderWidth: 2,
                  },
                },
              },
            });

            // Add chart annotation to simulate the "red line" in TVA animations
            const timelineDivider = document.createElement('div');
            timelineDivider.className = 'timeline-divider';
            document
              .querySelector('.chart-container')
              .appendChild(timelineDivider);
          },

          async fetchData() {
            try {
              // Fetch metrics
              const metricsResponse = await fetch('/api/v1/metrics');
              if (!metricsResponse.ok) {
                throw new Error('Metrics fetch failed');
              }
              const metricsData = await metricsResponse.json();

              // Update metrics
              this.metrics = {
                totalQueries: metricsData.totalQueries || 0,
                blockedQueries: metricsData.blockedQueries || 0,
                cacheHits: metricsData.cacheHits || 0,
                cacheMisses: metricsData.cacheMisses || 0,
              };

              // Fetch recent queries
              const queriesResponse = await fetch('/api/v1/queries');
              if (!queriesResponse.ok) {
                throw new Error('Queries fetch failed');
              }
              const queriesData = await queriesResponse.json();
              this.recentQueries = (queriesData.queries || []).map((q) => ({
                ...q,
                time: new Date(q.timestamp).toLocaleTimeString(),
              }));

              // Update status
              const statusResponse = await fetch('/api/v1/status');
              if (!statusResponse.ok) {
                throw new Error('Status fetch failed');
              }
              const statusData = await statusResponse.json();
              this.status = statusData.status;

              // Fetch hourly stats
              const statsResponse = await fetch('/api/v1/stats/hourly');
              if (!statsResponse.ok) {
                throw new Error('Hourly stats fetch failed');
              }
              const statsData = await statsResponse.json();

              // Fetch client stats
              const clientStatsResponse = await fetch('/api/v1/clients');
              if (!clientStatsResponse.ok) {
                throw new Error('Client stats fetch failed');
              }
              const clientStatsData = await clientStatsResponse.json();
              this.clientStats = clientStatsData.clients.map((client) => ({
                ...client,
                lastSeen: new Date(client.lastSeen).toLocaleString(),
              }));

              // Update chart
              if (chart) {
                chart.data.labels = statsData.hours;
                chart.data.datasets[0].data = statsData.requests;
                chart.data.datasets[1].data = statsData.blocks;
                chart.update();
              }
            } catch (error) {
              console.error('Failed to fetch data:', error);
              this.status = 'stopped';
            }
          },
        };
      }
    </script>
  </body>
</html>
