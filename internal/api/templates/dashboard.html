<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TVA Temporal Defense Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=B612+Mono:wght@400;700&family=DM+Serif+Display:ital@0;1&family=Space+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <!-- Add this font for cockpit theme -->
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      /* CRT screen effect - maintain scanlines but remove harsh flickering */
      .crt::before {
        content: ' ';
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(
            rgba(18, 16, 16, 0) 50%,
            rgba(0, 0, 0, 0.1) 50%
          ),
          linear-gradient(
            90deg,
            rgba(255, 0, 0, 0.03),
            rgba(0, 255, 0, 0.02),
            rgba(0, 0, 255, 0.03)
          );
        background-size: 100% 2px, 3px 100%;
        pointer-events: none;
        z-index: 100;
      }

      /* Optional subtle ambient glow instead */
      .crt::after {
        content: ' ';
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: radial-gradient(
          circle at center,
          transparent 60%,
          rgba(255, 107, 0, 0.09) 100%
        );
        pointer-events: none;
        z-index: 50;
      }

      /* Typewriter text effect */
      .typewriter {
        overflow: hidden;
        border-right: 0.15em solid #ff6b00;
        white-space: nowrap;
        letter-spacing: 0.15em;
        animation: typing 3.5s steps(40, end),
          blink-caret 0.75s step-end infinite;
      }

      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }

      @keyframes blink-caret {
        from,
        to {
          border-color: transparent;
        }
        50% {
          border-color: #ff6b00;
        }
      }

      /* TVA folder tab styling */
      .tva-tab {
        position: relative;
        overflow: hidden;
      }

      .tva-tab::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #d6bc97;
        clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
        z-index: -1;
      }

      /* TVA stamp effect */
      .tva-stamp {
        position: relative;
      }

      .tva-stamp::after {
        content: 'VARIANT';
        position: absolute;
        top: -15px;
        right: -15px;
        background: #ff6b00;
        color: #1a1512;
        padding: 5px 10px;
        font-family: 'B612 Mono', monospace;
        font-weight: bold;
        font-size: 0.6rem;
        transform: rotate(15deg);
        border: 1px solid #1a1512;
      }

      /* File folder styling */
      .file-folder {
        position: relative;
        background: #d6bc97;
        border: 1px solid #794b28;
        box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.2);
      }

      .file-tab {
        position: absolute;
        top: -15px;
        left: 20px;
        width: 80px;
        height: 15px;
        background: #d6bc97;
        border: 1px solid #794b28;
        border-bottom: none;
        border-radius: 5px 5px 0 0;
      }

      /* Scrollbar styling */
      ::-webkit-scrollbar {
        width: 14px;
        height: 14px;
      }

      ::-webkit-scrollbar-track {
        background: #251f17;
      }

      ::-webkit-scrollbar-thumb {
        background: #ff6b00;
        border: 2px solid #251f17;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #ff8b28;
      }

      /* Old CRT monitor glow */
      .monitor-glow {
        box-shadow: 0 0 10px rgba(255, 107, 0, 0.3),
          0 0 20px rgba(255, 107, 0, 0.2), inset 0 0 30px rgba(255, 107, 0, 0.2);
      }

      /* Miss Minutes dot animation */
      .miss-minutes-dot {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.7;
          transform: scale(0.9);
        }
      }

      body {
        background-color: #1a1512; /* Darker than the previous #251f17 */
        background-image: linear-gradient(
            rgba(255, 107, 0, 0.07) 1px,
            /* Slightly increased grid opacity for visibility */ transparent 1px
          ),
          linear-gradient(90deg, rgba(255, 107, 0, 0.07) 1px, transparent 1px);
        background-size: 20px 20px;
      }

      [x-cloak] {
        display: none !important;
      }

      /* Add these styles for timeline effects */
      .chart-container {
        position: relative;
        height: 280px;
        width: 100%;
        overflow: hidden;
      }

      /* Red line through timeline (similar to TVA's red timeline indicator) */
      .timeline-divider {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        width: 3px;
        background-color: rgba(255, 107, 0, 0.7);
        transform: translateX(50px);
        box-shadow: 0 0 10px rgba(255, 107, 0, 0.5);
        z-index: 1;
        animation: timeline-pulse 2s infinite;
      }

      @keyframes timeline-pulse {
        0%,
        100% {
          opacity: 1;
          box-shadow: 0 0 10px rgba(255, 107, 0, 0.5);
        }
        50% {
          opacity: 0.6;
          box-shadow: 0 0 15px rgba(255, 107, 0, 0.7);
        }
      }

      /* Update the chart section container */
      .mt-8.bg-tva-cream.rounded.border-2.border-tva-brown.monitor-glow {
        position: relative;
        overflow: hidden;
      }

      .mt-8.bg-tva-cream.rounded.border-2.border-tva-brown.monitor-glow::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: repeating-linear-gradient(
          to right,
          rgba(121, 75, 40, 0.05) 0px,
          rgba(121, 75, 40, 0.05) 1px,
          transparent 1px,
          transparent 20px
        );
        pointer-events: none;
      }

      /* Theme base classes */
      body {
        transition: background-color 0.5s ease;
      }

      /* TVA Theme (Default) */
      body.theme-tva {
        background-color: #1a1512;
        background-image: linear-gradient(
            rgba(255, 107, 0, 0.07) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(255, 107, 0, 0.07) 1px, transparent 1px);
        background-size: 20px 20px;
      }

      /* Cockpit Theme */
      body.theme-cockpit {
        background-color: #0a0e17;
        background-image: radial-gradient(
            circle at center,
            rgba(16, 185, 129, 0.05) 0%,
            transparent 80%
          ),
          linear-gradient(rgba(16, 185, 129, 0.05) 1px, transparent 1px),
          linear-gradient(90deg, rgba(16, 185, 129, 0.05) 1px, transparent 1px);
        background-size: 100% 100%, 20px 20px, 20px 20px;
      }

      /* Cockpit Theme Adjustments */
      .theme-cockpit .file-folder {
        background: rgba(16, 185, 129, 0.1);
        border: 1px solid #10b981;
        box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
      }

      .theme-cockpit .file-tab {
        background: rgba(16, 185, 129, 0.1);
        border: 1px solid #10b981;
      }

      .theme-cockpit .monitor-glow {
        box-shadow: 0 0 10px rgba(16, 185, 129, 0.3),
          0 0 20px rgba(16, 185, 129, 0.1),
          inset 0 0 30px rgba(16, 185, 129, 0.1);
      }

      .theme-cockpit .text-tva-tan {
        color: #e0f2f1;
      }

      .theme-cockpit .text-tva-amber {
        color: #38bdf8;
      }

      .theme-cockpit .text-tva-orange {
        color: #10b981;
      }

      .theme-cockpit .border-tva-orange {
        border-color: #10b981;
      }

      .theme-cockpit .border-tva-brown {
        border-color: #0284c7;
      }

      .theme-cockpit .bg-tva-cream {
        background-color: rgba(10, 14, 23, 0.8);
      }

      .theme-cockpit .bg-tva-dark {
        background-color: #0a0e17;
      }

      .theme-cockpit .bg-tva-black\\/30 {
        background-color: rgba(16, 185, 129, 0.1);
      }

      .theme-cockpit .bg-tva-tan {
        background-color: rgba(16, 185, 129, 0.2);
      }

      .theme-cockpit .bg-tva-brown {
        background-color: #0f766e;
      }

      .theme-cockpit .text-tva-dark {
        color: #e0f2f1;
      }

      .theme-cockpit .miss-minutes-dot {
        color: #38bdf8;
      }

      /* Radar animation for cockpit theme */
      .theme-cockpit .chart-container::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 150%;
        height: 150%;
        background: conic-gradient(
          rgba(16, 185, 129, 0.3) 0deg,
          rgba(16, 185, 129, 0.1) 30deg,
          transparent 60deg,
          transparent 360deg
        );
        z-index: 2;
        opacity: 0.7;
        pointer-events: none;
        animation: radar-sweep 4s linear infinite;
        transform-origin: center;
      }

      @keyframes radar-sweep {
        from {
          transform: translate(-50%, -50%) rotate(0deg);
        }
        to {
          transform: translate(-50%, -50%) rotate(360deg);
        }
      }

      /* Cockpit timeline divider style */
      .theme-cockpit .timeline-divider {
        background-color: rgba(16, 185, 129, 0.7);
        box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
      }

      @keyframes timeline-pulse-cockpit {
        0%,
        100% {
          opacity: 1;
          box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }
        50% {
          opacity: 0.6;
          box-shadow: 0 0 15px rgba(16, 185, 129, 0.7);
        }
      }

      .theme-cockpit .timeline-divider {
        animation: timeline-pulse-cockpit 2s infinite;
      }

      /* Theme transition effect */
      .theme-transitioning {
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      body {
        transition: opacity 0.4s ease, background-color 0.5s ease;
      }

      /* More dramatic cockpit theme adjustments */
      .theme-cockpit {
        background-color: #0a1020;
        background-image: linear-gradient(
            rgba(16, 185, 129, 0.03) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(16, 185, 129, 0.03) 1px, transparent 1px);
        background-size: 20px 20px;
        font-family: 'B612 Mono', 'Roboto Mono', monospace;
      }

      /* Complete sidebar transformation for cockpit theme */
      .theme-cockpit .sidebar-tva {
        display: none !important;
      }

      .theme-cockpit .sidebar-cockpit {
        display: flex !important;
      }

      .theme-cockpit .header-tva {
        display: none !important;
      }

      .theme-cockpit .header-cockpit {
        display: flex !important;
      }

      /* Card transformations */
      .theme-cockpit .file-folder {
        background: rgba(10, 16, 32, 0.8);
        border: 1px solid #38bdf8;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(56, 189, 248, 0.2),
          inset 0 0 20px rgba(16, 185, 129, 0.1);
      }

      .theme-cockpit .file-tab {
        display: none;
      }

      /* Completely hide TVA-specific elements */
      .theme-cockpit .tva-only {
        display: none !important;
      }

      /* Show cockpit-specific elements */
      .cockpit-only {
        display: none !important; /* Use !important to ensure it's hidden initially */
      }

      .theme-cockpit .cockpit-only {
        display: block !important; /* Use !important to override previous rule */
      }

      /* Special case for flex elements */
      .theme-cockpit .cockpit-only.flex,
      .theme-cockpit .header-cockpit {
        display: flex !important;
      }

      /* Cockpit instrumentation styling */
      .theme-cockpit .cockpit-gauge {
        position: relative;
        width: 100%;
        height: 120px;
        background: #0a1020;
        border-radius: 10px;
        border: 1px solid #38bdf8;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.15);
      }

      .theme-cockpit .cockpit-gauge::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
          circle at center,
          rgba(16, 185, 129, 0.15) 0%,
          transparent 70%
        );
        pointer-events: none;
      }

      .theme-cockpit .gauge-value {
        font-size: 2rem;
        font-weight: bold;
        color: #38bdf8;
        text-shadow: 0 0 10px rgba(56, 189, 248, 0.5);
        z-index: 1;
        font-family: 'Orbitron', sans-serif;
        letter-spacing: 1px;
      }

      .theme-cockpit .gauge-label {
        text-transform: uppercase;
        font-size: 0.7rem;
        color: #10b981;
        margin-top: 8px;
        font-weight: bold;
        letter-spacing: 2px;
      }

      /* Cockpit tables */
      .theme-cockpit table {
        background-color: rgba(10, 16, 32, 0.8);
        border-collapse: separate;
        border-spacing: 0;
        border: 1px solid #38bdf8;
      }

      .theme-cockpit thead th {
        background-color: #072d3a;
        color: #38bdf8;
        font-size: 0.7rem;
        letter-spacing: 1px;
        text-transform: uppercase;
        padding: 0.75rem 1rem;
        border-bottom: 1px solid #10b981;
      }

      .theme-cockpit tbody td {
        color: #e0f2f1;
        border-bottom: 1px solid rgba(16, 185, 129, 0.2);
        padding: 0.75rem 1rem;
      }

      .theme-cockpit tbody tr:hover {
        background-color: rgba(16, 185, 129, 0.1);
      }

      /* Cockpit digital time */
      .theme-cockpit .digital-clock {
        font-family: 'Orbitron', sans-serif;
        background: #051826;
        color: #10b981;
        padding: 0.5rem;
        border-radius: 4px;
        text-align: center;
        letter-spacing: 2px;
        border: 1px solid #38bdf8;
        box-shadow: 0 0 10px rgba(56, 189, 248, 0.3);
        animation: cockpit-pulse 3s infinite;
      }

      /* Blinking indicators */
      @keyframes cockpit-blink {
        0%,
        49% {
          opacity: 1;
        }
        50%,
        100% {
          opacity: 0.3;
        }
      }

      .theme-cockpit .blink-slow {
        animation: cockpit-blink 2s infinite;
      }

      /* HUD screen styling */
      .theme-cockpit .hud-screen {
        background-color: rgba(10, 20, 30, 0.9);
        border: 1px solid #38bdf8;
        border-radius: 8px;
        padding: 1rem;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.2),
          inset 0 0 40px rgba(16, 185, 129, 0.05);
      }

      .theme-cockpit .hud-screen::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          to bottom,
          transparent,
          rgba(16, 185, 129, 0.03) 50%,
          transparent 51%,
          transparent
        );
        background-size: 100% 6px;
        pointer-events: none;
        opacity: 0.7;
        z-index: 5;
      }

      .theme-cockpit .hud-title {
        color: #10b981;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 2px;
        font-weight: bold;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .theme-cockpit .hud-title::after {
        content: '';
        display: block;
        width: 8px;
        height: 8px;
        background-color: #38bdf8;
        border-radius: 50%;
        animation: cockpit-blink 1.5s infinite;
      }

      /* Cockpit navigation panel */
      .theme-cockpit .cockpit-nav-button {
        background: linear-gradient(to bottom, #072d3a 0%, #051826 100%);
        border: 1px solid #38bdf8;
        color: #10b981;
        padding: 0.75rem 1rem;
        border-radius: 4px;
        display: flex;
        align-items: center;
        margin-bottom: 0.5rem;
        transition: all 0.2s ease;
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 1px;
      }

      .theme-cockpit .cockpit-nav-button:hover {
        background: linear-gradient(to bottom, #0a3d4f 0%, #072d3a 100%);
        box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
      }

      .theme-cockpit .cockpit-nav-button.active {
        background: linear-gradient(to bottom, #0f766e 0%, #0a3d4f 100%);
        box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        color: #e0f2f1;
      }

      /* Additional styles to enhance cockpit theme */
      .theme-cockpit .bg-tva-cream {
        background-color: rgba(
          5,
          15,
          25,
          0.9
        ); /* Darker background for better contrast */
      }

      /* Improve table contrast */
      .theme-cockpit table {
        border: 1px solid #38bdf8;
      }

      .theme-cockpit tbody tr:hover {
        background-color: rgba(16, 185, 129, 0.1);
      }

      /* Add some glowing effects to important elements */
      .theme-cockpit .cockpit-gauge {
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.15);
      }

      /* Add scan line effect for cockpit screens */
      .theme-cockpit .hud-screen::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          to bottom,
          transparent,
          rgba(16, 185, 129, 0.03) 50%,
          transparent 51%,
          transparent
        );
        background-size: 100% 6px;
        pointer-events: none;
        opacity: 0.7;
        z-index: 5;
      }

      /* Add a subtle pulse to important indicators */
      @keyframes cockpit-pulse {
        0%,
        100% {
          box-shadow: 0 0 10px rgba(16, 185, 129, 0.3);
        }
        50% {
          box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }
      }

      .theme-cockpit .digital-clock {
        animation: cockpit-pulse 3s infinite;
      }

      /* Responsive improvements for cockpit theme */
      @media (max-width: 768px) {
        .theme-cockpit .cockpit-gauge {
          height: 100px;
        }

        .theme-cockpit .gauge-value {
          font-size: 1.6rem;
        }

        .theme-cockpit .gauge-label {
          font-size: 0.6rem;
        }

        .theme-cockpit .hud-title {
          font-size: 0.7rem;
        }
      }

      /* For TVA theme chart container */
      .theme-tva .chart-container {
        position: relative;
        background-color: #1a1512 !important;
        border-radius: 4px;
        border: 1px solid #794b28 !important;
        box-shadow: 0 0 20px rgba(255, 107, 0, 0.1),
          inset 0 0 30px rgba(121, 75, 40, 0.2);
        padding: 10px;
      }

      /* For Cockpit theme chart container */
      .theme-cockpit .chart-container {
        position: relative;
        background-color: #051826 !important;
        border-radius: 4px;
        border: 1px solid #38bdf8 !important;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.2),
          inset 0 0 30px rgba(16, 185, 129, 0.1);
        padding: 10px;
      }

      /* Improve contrast for timeline divider on dark background */
      .theme-tva .timeline-divider {
        background-color: rgba(255, 107, 0, 0.8);
        box-shadow: 0 0 15px rgba(255, 107, 0, 0.5);
      }

      /* Update background specifically for TVA chart card */
      .theme-tva .bg-tva-cream .chart-container {
        background-color: #1a1512 !important;
      }
    </style>
  </head>

  <body class="font-mono text-tva-tan crt relative" x-data="dashboard()">
    <div class="min-h-screen flex">
      <!-- Include the sidebar template -->
      {{template "sidebar.html" .}}

      <!-- Main Content -->
      <main class="ml-64 flex-1 p-6 pb-24">
        <!-- Dashboard content (show when currentPage is dashboard) -->
        <div x-show="currentPage === 'dashboard'">
          <!-- TVA Header -->
          <header
            class="header-tva flex justify-between items-center mb-8"
            x-show="currentTheme === 'tva'"
          >
            <div>
              <h1 class="text-3xl font-serif text-tva-amber">
                Variant Detection Center
              </h1>
              <p class="text-sm text-tva-tan mt-1 opacity-70 font-mono">
                ACTIVE MONITORING: DOMAIN NEXUS BRANCH-38F
              </p>
            </div>

            <div
              class="border border-tva-orange px-4 py-1 rounded bg-tva-black/30 monitor-glow"
            >
              <div class="text-xs text-tva-orange mb-1 font-mono">
                TIMELINE INTEGRITY:
              </div>
              <div class="flex items-center space-x-2">
                <span
                  class="text-tva-amber font-serif text-xl"
                  x-text="status === 'running' ? 'STABLE' : 'COMPROMISED'"
                ></span>
                <span class="miss-minutes-dot text-tva-amber text-lg">●</span>
              </div>
            </div>
          </header>

          <!-- Cockpit Header -->
          <header
            class="header-cockpit cockpit-only flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"
            x-show="currentTheme === 'cockpit'"
          >
            <div>
              <h1
                class="text-3xl font-['Orbitron'] text-[#38bdf8] tracking-wide"
              >
                Defense System
              </h1>
              <p class="text-sm text-[#10b981] mt-2 uppercase tracking-wider">
                Active Surveillance: Monitor Alpha-3
              </p>
            </div>

            <div class="flex space-x-4">
              <div class="digital-clock">
                <div class="text-xs mb-1">LOCAL TIME</div>
                <div
                  class="text-lg"
                  x-text="new Date().toLocaleTimeString('en-US', {hour12: false})"
                ></div>
              </div>

              <div class="digital-clock">
                <div class="text-xs mb-1">STATUS</div>
                <div
                  class="text-lg"
                  x-text="status === 'running' ? 'SHIELDED' : 'COMPROMISED'"
                  :class="status === 'running' ? 'text-[#10b981]' : 'text-red-500'"
                ></div>
              </div>
            </div>
          </header>

          <!-- Timestamp -->
          <div class="flex justify-between items-center mb-6">
            <div
              class="text-sm text-tva-orange font-mono border-b border-tva-orange/30 inline-block pb-1 typewriter"
            >
              TIMESTAMP: <span x-text="new Date().toLocaleString()"></span>
            </div>
            <div class="text-sm text-tva-orange font-mono">
              OPERATION:
              <span class="text-tva-amber">TIMELINE DEFENSE PROTOCOL</span>
            </div>
          </div>

          <!-- TVA Stats Cards (keep existing) -->
          <div
            class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 tva-only"
          >
            <div class="file-folder overflow-hidden rounded">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-tva-orange p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-black"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Total Nexus Events
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.totalQueries"
                    ></p>
                  </div>
                </div>
              </div>
            </div>

            <div class="file-folder overflow-hidden rounded tva-stamp">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-red-600 p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-cream"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Pruned Branches
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.blockedQueries"
                    ></p>
                  </div>
                </div>
              </div>
            </div>

            <div class="file-folder overflow-hidden rounded">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-tva-amber p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-dark"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Archive Retrievals
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.cacheHits"
                    ></p>
                  </div>
                </div>
              </div>
            </div>

            <div class="file-folder overflow-hidden rounded">
              <div class="file-tab"></div>
              <div class="px-6 py-5">
                <div class="flex items-center">
                  <div class="rounded-lg bg-tva-brown p-2 mr-4">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-tva-cream"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                      />
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-mono text-tva-brown uppercase">
                      Pruning Rate
                    </p>
                    <p
                      class="mt-1 text-2xl font-serif text-tva-dark"
                      x-text="metrics.totalQueries > 0 ? ((metrics.blockedQueries / metrics.totalQueries) * 100).toFixed(1) + '%' : '0%'"
                    ></p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Cockpit Stats Displays -->
          <div
            class="cockpit-only grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"
          >
            <div class="cockpit-gauge">
              <div class="gauge-value" x-text="metrics.totalQueries"></div>
              <div class="gauge-label">Total Requests</div>
            </div>

            <div class="cockpit-gauge">
              <div class="gauge-value" x-text="metrics.blockedQueries"></div>
              <div class="gauge-label">Threats Blocked</div>
            </div>

            <div class="cockpit-gauge">
              <div class="gauge-value" x-text="metrics.cacheHits"></div>
              <div class="gauge-label">Cache Retrieval</div>
            </div>

            <div class="cockpit-gauge">
              <div
                class="gauge-value"
                x-text="metrics.totalQueries > 0 ? ((metrics.blockedQueries / metrics.totalQueries) * 100).toFixed(1) + '%' : '0%'"
              ></div>
              <div class="gauge-label">Protection Rate</div>
            </div>
          </div>

          <!-- Chart Section -->
          <div
            class="mt-8 bg-tva-cream rounded border-2 border-tva-brown monitor-glow"
          >
            <div
              class="bg-tva-brown text-tva-cream px-6 py-3 flex justify-between items-center"
            >
              <h2 class="text-lg font-serif">TIMELINE BRANCH ANALYSIS</h2>
              <div
                class="text-xs font-mono bg-tva-orange/20 px-3 py-1 rounded text-tva-orange border border-tva-orange"
              >
                CLASSIFIED
              </div>
            </div>
            <div class="p-6 bg-tva-cream">
              <div class="chart-container">
                <canvas id="statsChart"></canvas>
                <!-- The timeline-divider will be added by JavaScript -->
              </div>
            </div>
          </div>

          <!-- Chart Section for Cockpit -->
          <div class="mt-8 hud-screen cockpit-only">
            <div class="hud-title">
              <span>THREAT DETECTION RADAR</span>
            </div>
            <div class="chart-container">
              <canvas id="statsChart"></canvas>
            </div>
          </div>

          <!-- Tables -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
            <!-- Variant registry table -->
            <div
              class="bg-tva-cream rounded border-2 border-tva-brown monitor-glow tva-only"
            >
              <div class="bg-tva-brown text-tva-cream px-6 py-3">
                <h2 class="text-lg font-serif">SUBJECT REGISTRY</h2>
              </div>
              <div class="overflow-x-auto" style="max-height: 400px">
                <table class="min-w-full">
                  <thead class="bg-tva-tan border-b border-tva-brown">
                    <tr>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        IP IDENTIFIER
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        EVENTS
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        PRUNED
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        LAST DETECTION
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    class="divide-y divide-tva-brown/30 bg-tva-cream text-tva-dark"
                  >
                    <template x-for="client in clientStats" :key="client.ip">
                      <tr
                        class="hover:bg-tva-tan transition-colors cursor-pointer"
                      >
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm font-mono"
                          x-text="client.ip"
                        ></td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm"
                          x-text="client.totalQueries"
                        ></td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm"
                          x-text="client.blockedQueries"
                        ></td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm text-tva-brown"
                          x-text="client.lastSeen"
                        ></td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Recent Variants -->
            <div
              class="bg-tva-cream rounded border-2 border-tva-brown monitor-glow tva-only"
            >
              <div class="bg-tva-brown text-tva-cream px-6 py-3">
                <h2 class="text-lg font-serif">NEXUS EVENT LOG</h2>
              </div>
              <div class="overflow-x-auto" style="max-height: 400px">
                <table class="min-w-full">
                  <thead class="bg-tva-tan border-b border-tva-brown">
                    <tr>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        DOMAIN
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        STATUS
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-mono uppercase tracking-wider text-tva-dark"
                      >
                        TIMESTAMP
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    class="divide-y divide-tva-brown/30 bg-tva-cream text-tva-dark"
                  >
                    <template x-for="query in recentQueries" :key="query.id">
                      <tr
                        class="hover:bg-tva-tan transition-colors cursor-pointer"
                      >
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm font-mono"
                          x-text="query.domain"
                        ></td>
                        <td class="px-6 py-4 whitespace-nowrap">
                          <span
                            class="px-2 py-1 text-xs font-mono uppercase"
                            :class="query.blocked ? 'bg-red-100 text-red-800 border-red-800' : 'bg-green-100 text-green-800 border-green-800'"
                            x-text="query.blocked ? 'BLOCKED' : 'ALLOWED'"
                          ></span>
                        </td>
                        <td
                          class="px-6 py-4 whitespace-nowrap text-sm text-tva-brown"
                          x-text="query.time"
                        ></td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Cockpit Tables -->
            <div class="hud-screen cockpit-only">
              <div class="hud-title">
                <span>NETWORK SUBJECTS</span>
              </div>
              <div class="overflow-x-auto" style="max-height: 400px">
                <table class="min-w-full">
                  <thead>
                    <tr>
                      <th>IP ADDRESS</th>
                      <th>REQUESTS</th>
                      <th>BLOCKS</th>
                      <th>LAST SEEN</th>
                    </tr>
                  </thead>
                  <tbody>
                    <template x-for="client in clientStats" :key="client.ip">
                      <tr>
                        <td x-text="client.ip"></td>
                        <td x-text="client.totalQueries"></td>
                        <td x-text="client.blockedQueries"></td>
                        <td x-text="client.lastSeen"></td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="hud-screen cockpit-only">
              <div class="hud-title">
                <span>SECURITY LOG</span>
              </div>
              <div class="overflow-x-auto" style="max-height: 400px">
                <table class="min-w-full">
                  <thead>
                    <tr>
                      <th>DOMAIN</th>
                      <th>STATUS</th>
                      <th>TIME</th>
                    </tr>
                  </thead>
                  <tbody>
                    <template x-for="query in recentQueries" :key="query.id">
                      <tr>
                        <td x-text="query.domain"></td>
                        <td>
                          <span
                            class="px-2 py-1 text-xs uppercase"
                            :class="query.blocked ? 'bg-red-900/30 text-red-400' : 'bg-emerald-900/30 text-emerald-400'"
                            x-text="query.blocked ? 'BLOCKED' : 'CLEARED'"
                          ></span>
                        </td>
                        <td x-text="query.time"></td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Footer -->
          <!-- TVA Footer (keep existing) -->
          <footer
            class="mt-12 pb-6 border-t border-tva-orange/20 pt-4 tva-only"
          >
            <div class="flex justify-center items-center space-x-4">
              <div
                class="bg-tva-black/30 border border-tva-orange/70 rounded px-4 py-2 monitor-glow"
              >
                <div class="flex items-center space-x-3">
                  <div>
                    <div class="text-xs font-mono text-tva-orange mb-1">
                      SYSTEM OPERATIONAL TIME
                    </div>
                    <div class="flex items-center">
                      <span
                        class="font-mono text-tva-amber text-xl"
                        x-text="formatUptime()"
                      ></span>
                      <span class="miss-minutes-dot text-tva-amber ml-2"
                        >●</span
                      >
                    </div>
                  </div>
                  <div
                    class="hidden sm:block border-l border-tva-orange/30 pl-3 h-12"
                  >
                    <div class="text-xs font-mono text-tva-orange mb-1">
                      TIMELINE INTEGRITY
                    </div>
                    <div
                      class="w-24 bg-tva-black/50 h-2 rounded-full overflow-hidden"
                    >
                      <div
                        class="h-full bg-tva-orange"
                        :style="`width: ${getUptimePercentage()}%`"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="hidden md:block text-center text-xs text-tva-tan">
                <p>FOR ALL TIME. ALWAYS.</p>
              </div>
            </div>
          </footer>

          <!-- Cockpit Footer -->
          <footer
            class="mt-12 pb-6 border-t border-[#38bdf8]/20 pt-4 cockpit-only"
          >
            <div class="flex justify-center items-center space-x-4">
              <div class="digital-clock">
                <div class="text-xs mb-1">UPTIME</div>
                <div class="text-lg" x-text="formatUptime()"></div>
              </div>

              <div class="hidden md:block text-center">
                <div class="text-[#10b981] text-xs">
                  SECURE FLIGHT PROTOCOL ACTIVE
                </div>
              </div>
            </div>
          </footer>
        </div>

        <!-- Blocklists content (show when currentPage is blocklists) -->
        <div x-show="currentPage === 'blocklists'" x-cloak>
          <header
            class="flex justify-between items-center mb-8 pb-4 border-b border-neo-blue border-opacity-20"
          >
            <h1 class="text-2xl font-orbitron font-bold glow-text-blue">
              Blocklist Management
            </h1>
            <!-- Status indicator -->
          </header>

          <!-- Blocklist content -->
          <div class="bg-neo-dark neo-border neo-overlay rounded-lg p-6">
            <!-- Table for blocklists -->
          </div>
        </div>

        <!-- Settings content (show when currentPage is settings) -->
        <div x-show="currentPage === 'settings'" x-cloak>
          <!-- Settings content -->
        </div>

        <!-- About content (show when currentPage is about) -->
        <div x-show="currentPage === 'about'" x-cloak>
          <!-- About content -->
        </div>
      </main>
    </div>

    <!-- Make sure this path is correct -->
    <script src="/static/js/dashboard.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Check for saved theme
        const savedTheme = localStorage.getItem('theme') || 'tva';
        document.body.classList.add(`theme-${savedTheme}`);
      });
    </script>
  </body>
</html>
